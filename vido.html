<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LearnHub - Next-Gen Educational Platform</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #4361ee;
            --secondary-color: #3f37c9;
            --accent-color: #4cc9f0;
            --dark-color: #1a1a2e;
            --light-color: #f8f9fa;
            --success-color: #4caf50;
            --warning-color: #ff9800;
            --danger-color: #f44336;
            --text-color: #2b2d42;
            --light-text: #8d99ae;
            --shadow-sm: 0 1px 3px rgba(0,0,0,0.12);
            --shadow-md: 0 4px 6px rgba(0,0,0,0.1);
            --shadow-lg: 0 10px 25px rgba(0,0,0,0.1);
            --transition: all 0.3s ease;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', -apple-system, BlinkMacSystemFont, sans-serif;
        }
        
        body {
            background-color: #f5f7ff;
            color: var(--text-color);
            line-height: 1.6;
        }
        
        /* Dark mode */
        body.dark-mode {
            background-color: var(--dark-color);
            color: #f8f9fa;
            --text-color: #f8f9fa;
            --light-text: #adb5bd;
        }
        
        body.dark-mode header,
        body.dark-mode .video-card,
        body.dark-mode .video-description,
        body.dark-mode .related-video-card,
        body.dark-mode .ai-assistant,
        body.dark-mode .notes-panel {
            background-color: #16213e;
            border-color: #1f2a4a;
        }
        
        /* Header */
        header {
            background-color: white;
            padding: 1rem 2rem;
            box-shadow: var(--shadow-md);
            position: sticky;
            top: 0;
            z-index: 1000;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            transition: var(--transition);
        }
        
        .logo-container {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .logo {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary-color);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .logo i {
            font-size: 1.5rem;
        }
        
        .header-controls {
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }
        
        .search-container {
            display: flex;
            flex-grow: 1;
            max-width: 600px;
            margin: 0 2rem;
            position: relative;
        }
        
        .search-bar {
            width: 100%;
            padding: 0.8rem 1.5rem;
            border: 2px solid #e9ecef;
            border-radius: 50px;
            font-size: 1rem;
            transition: var(--transition);
            padding-left: 3rem;
            background-color: #f8f9fa;
        }
        
        .search-bar:focus {
            outline: none;
            border-color: var(--primary-color);
            background-color: white;
            box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.2);
        }
        
        .search-icon {
            position: absolute;
            left: 1.2rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--light-text);
        }
        
        .filter-container {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }
        
        select {
            padding: 0.6rem 1rem;
            border-radius: 50px;
            border: 2px solid #e9ecef;
            background-color: #f8f9fa;
            font-size: 0.9rem;
            cursor: pointer;
            transition: var(--transition);
        }
        
        select:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.2);
        }
        
        .user-controls {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .theme-toggle, .ai-assistant-btn {
            background: none;
            border: none;
            font-size: 1.2rem;
            cursor: pointer;
            color: var(--text-color);
            transition: var(--transition);
            width: 2.5rem;
            height: 2.5rem;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .theme-toggle:hover, .ai-assistant-btn:hover {
            background-color: #f1f3f5;
        }
        
        .user-avatar {
            width: 2.5rem;
            height: 2.5rem;
            border-radius: 50%;
            background-color: var(--primary-color);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            cursor: pointer;
        }
        
        /* Main content */
        .main {
            padding: 2rem;
            max-width: 1800px;
            margin: 0 auto;
        }
        
        /* Video Grid View */
        .video-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
        }
        
        .video-card {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: var(--shadow-sm);
            cursor: pointer;
            transition: var(--transition);
            position: relative;
            border: 1px solid #e9ecef;
        }
        
        .video-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }
        
        .video-card-badge {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            background-color: var(--primary-color);
            color: white;
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
            font-size: 0.7rem;
            font-weight: bold;
        }
        
        .thumbnail-container {
            position: relative;
        }
        
        .thumbnail {
            width: 100%;
            height: 180px;
            object-fit: cover;
            display: block;
        }
        
        .duration {
            position: absolute;
            bottom: 0.5rem;
            right: 0.5rem;
            background-color: rgba(0,0,0,0.7);
            color: white;
            padding: 0.2rem 0.4rem;
            border-radius: 4px;
            font-size: 0.8rem;
        }
        
        .video-info {
            padding: 1rem;
        }
        
        .video-title {
            font-weight: 600;
            margin-bottom: 0.5rem;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            font-size: 1rem;
        }
        
        .video-meta {
            color: var(--light-text);
            font-size: 0.85rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .video-meta i {
            font-size: 0.7rem;
        }
        
        .progress-container {
            width: 100%;
            height: 4px;
            background-color: #e9ecef;
            position: absolute;
            bottom: 0;
            left: 0;
        }
        
        .progress-bar {
            height: 100%;
            background-color: var(--primary-color);
            width: 0%;
        }
        
        /* Video Detail View */
        .video-detail {
            display: none;
            margin-bottom: 2rem;
        }
        
        .video-player-container {
            position: relative;
            width: 100%;
            margin-bottom: 1.5rem;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: var(--shadow-lg);
        }
        
        .main-video {
            width: 100%;
            aspect-ratio: 16/9;
            background: #000;
        }
        
        .video-actions {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 1rem 0;
        }
        
        .action-buttons {
            display: flex;
            gap: 1rem;
        }
        
        .action-btn {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            background: none;
            border: none;
            color: var(--text-color);
            cursor: pointer;
            font-size: 0.9rem;
            padding: 0.5rem 1rem;
            border-radius: 50px;
            transition: var(--transition);
        }
        
        .action-btn:hover {
            background-color: #f1f3f5;
        }
        
        .action-btn i {
            font-size: 1rem;
        }
        
        .action-btn.like.active {
            color: var(--success-color);
        }
        
        .action-btn.bookmark.active {
            color: var(--warning-color);
        }
        
        .video-description {
            background: white;
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: var(--shadow-sm);
            margin-bottom: 1.5rem;
            border: 1px solid #e9ecef;
        }
        
        .description-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }
        
        .description-title {
            font-size: 1.3rem;
            font-weight: 600;
        }
        
        .description-meta {
            color: var(--light-text);
            font-size: 0.9rem;
            display: flex;
            gap: 1rem;
        }
        
        .description-text {
            margin-bottom: 1rem;
        }
        
        .tags {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }
        
        .tag {
            background-color: #e9ecef;
            color: var(--text-color);
            padding: 0.3rem 0.8rem;
            border-radius: 50px;
            font-size: 0.8rem;
            transition: var(--transition);
        }
        
        .tag:hover {
            background-color: #dee2e6;
        }
        
        /* Related videos */
        .related-videos {
            margin: 2rem 0;
        }
        
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }
        
        .section-title {
            font-size: 1.2rem;
            font-weight: 600;
        }
        
        .view-all {
            color: var(--primary-color);
            font-size: 0.9rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }
        
        .related-by-class {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            max-height: 600px;
            overflow-y: auto;
            padding-right: 1rem;
        }
        
        .related-by-subject {
            display: flex;
            gap: 1.5rem;
            overflow-x: auto;
            padding: 1rem 0;
            scrollbar-width: thin;
        }
        
        .related-by-subject::-webkit-scrollbar {
            height: 6px;
        }
        
        .related-by-subject::-webkit-scrollbar-thumb {
            background-color: #adb5bd;
            border-radius: 3px;
        }
        
        .related-video-card {
            flex: 0 0 auto;
            width: 280px;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: var(--shadow-sm);
            border: 1px solid #e9ecef;
            transition: var(--transition);
        }
        
        .related-video-card:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-md);
        }
        
        /* Learning path */
        .learning-path {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            margin: 2rem 0;
            box-shadow: var(--shadow-sm);
            border: 1px solid #e9ecef;
        }
        
        .path-item {
            display: flex;
            align-items: center;
            padding: 1rem 0;
            border-bottom: 1px solid #e9ecef;
        }
        
        .path-item:last-child {
            border-bottom: none;
        }
        
        .path-status {
            width: 2rem;
            height: 2rem;
            border-radius: 50%;
            background-color: #e9ecef;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 1rem;
            flex-shrink: 0;
        }
        
        .path-status.completed {
            background-color: var(--success-color);
            color: white;
        }
        
        .path-status.current {
            background-color: var(--primary-color);
            color: white;
        }
        
        .path-content {
            flex-grow: 1;
        }
        
        .path-title {
            font-weight: 500;
            margin-bottom: 0.3rem;
        }
        
        .path-meta {
            color: var(--light-text);
            font-size: 0.85rem;
            display: flex;
            gap: 1rem;
        }
        
        /* AI Assistant */
        .ai-assistant {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            width: 350px;
            background: white;
            border-radius: 12px;
            box-shadow: var(--shadow-lg);
            z-index: 1000;
            transform: translateY(150%);
            transition: transform 0.3s ease;
            border: 1px solid #e9ecef;
            display: none;
        }
        
        .ai-assistant.active {
            transform: translateY(0);
            display: block;
        }
        
        .ai-header {
            background-color: var(--primary-color);
            color: white;
            padding: 1rem;
            border-radius: 12px 12px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .ai-title {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-weight: 500;
        }
        
        .ai-close {
            background: none;
            border: none;
            color: white;
            font-size: 1.2rem;
            cursor: pointer;
        }
        
        .ai-messages {
            height: 300px;
            overflow-y: auto;
            padding: 1rem;
            background-color: #f8f9fa;
        }
        
        .message {
            margin-bottom: 1rem;
            max-width: 80%;
        }
        
        .user-message {
            margin-left: auto;
            background-color: var(--primary-color);
            color: white;
            padding: 0.8rem 1rem;
            border-radius: 18px 18px 0 18px;
        }
        
        .ai-message {
            background-color: white;
            padding: 0.8rem 1rem;
            border-radius: 18px 18px 18px 0;
            box-shadow: var(--shadow-sm);
        }
        
        .ai-input-container {
            display: flex;
            padding: 1rem;
            border-top: 1px solid #e9ecef;
        }
        
        .ai-input {
            flex-grow: 1;
            padding: 0.8rem 1rem;
            border: 1px solid #e9ecef;
            border-radius: 50px;
            margin-right: 0.5rem;
        }
        
        .ai-send {
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .ai-send:hover {
            background-color: var(--secondary-color);
        }
        
        /* Notes panel */
        .notes-panel {
            position: fixed;
            top: 0;
            right: 0;
            width: 350px;
            height: 100vh;
            background: white;
            box-shadow: var(--shadow-lg);
            z-index: 999;
            transform: translateX(100%);
            transition: transform 0.3s ease;
            display: flex;
            flex-direction: column;
            border-left: 1px solid #e9ecef;
        }
        
        .notes-panel.active {
            transform: translateX(0);
        }
        
        .notes-header {
            padding: 1rem;
            border-bottom: 1px solid #e9ecef;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .notes-title {
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .notes-close {
            background: none;
            border: none;
            font-size: 1.2rem;
            cursor: pointer;
        }
        
        .notes-content {
            flex-grow: 1;
            padding: 1rem;
            overflow-y: auto;
        }
        
        .note {
            background-color: #f8f9fa;
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
            position: relative;
        }
        
        .note-timestamp {
            font-size: 0.7rem;
            color: var(--light-text);
            margin-bottom: 0.5rem;
        }
        
        .note-text {
            margin-bottom: 0.5rem;
        }
        
        .note-actions {
            display: flex;
            gap: 0.5rem;
            justify-content: flex-end;
        }
        
        .note-action {
            background: none;
            border: none;
            color: var(--light-text);
            font-size: 0.8rem;
            cursor: pointer;
        }
        
        .note-action:hover {
            color: var(--primary-color);
        }
        
        .notes-input-container {
            padding: 1rem;
            border-top: 1px solid #e9ecef;
        }
        
        .notes-input {
            width: 100%;
            padding: 0.8rem 1rem;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            margin-bottom: 0.5rem;
            resize: none;
            min-height: 80px;
        }
        
        .notes-save {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 0.6rem 1.2rem;
            border-radius: 50px;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .notes-save:hover {
            background-color: var(--secondary-color);
        }
        
        /* Quiz panel */
        .quiz-panel {
            position: fixed;
            bottom: 2rem;
            left: 2rem;
            width: 350px;
            background: white;
            border-radius: 12px;
            box-shadow: var(--shadow-lg);
            z-index: 1000;
            transform: translateY(150%);
            transition: transform 0.3s ease;
            border: 1px solid #e9ecef;
            display: none;
        }
        
        .quiz-panel.active {
            transform: translateY(0);
            display: block;
        }
        
        .quiz-header {
            background-color: var(--primary-color);
            color: white;
            padding: 1rem;
            border-radius: 12px 12px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .quiz-title {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-weight: 500;
        }
        
        .quiz-close {
            background: none;
            border: none;
            color: white;
            font-size: 1.2rem;
            cursor: pointer;
        }
        
        .quiz-content {
            padding: 1rem;
            max-height: 400px;
            overflow-y: auto;
        }
        
        .quiz-question {
            margin-bottom: 1.5rem;
        }
        
        .quiz-question-text {
            margin-bottom: 1rem;
            font-weight: 500;
        }
        
        .quiz-options {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        
        .quiz-option {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.8rem;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .quiz-option:hover {
            background-color: #f8f9fa;
        }
        
        .quiz-option.selected {
            border-color: var(--primary-color);
            background-color: #f0f4ff;
        }
        
        .quiz-option.correct {
            border-color: var(--success-color);
            background-color: #e8f5e9;
        }
        
        .quiz-option.incorrect {
            border-color: var(--danger-color);
            background-color: #ffebee;
        }
        
        .quiz-footer {
            padding: 1rem;
            border-top: 1px solid #e9ecef;
            display: flex;
            justify-content: space-between;
        }
        
        .quiz-progress {
            font-size: 0.9rem;
            color: var(--light-text);
        }
        
        .quiz-next {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 0.6rem 1.2rem;
            border-radius: 50px;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .quiz-next:hover {
            background-color: var(--secondary-color);
        }
        
        .quiz-next:disabled {
            background-color: #e9ecef;
            cursor: not-allowed;
        }
        
        /* Back to grid button */
        .back-to-grid {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--primary-color);
            background: none;
            border: none;
            font-size: 1rem;
            cursor: pointer;
            margin-bottom: 1rem;
            padding: 0.5rem 1rem;
            border-radius: 50px;
            transition: var(--transition);
        }
        
        .back-to-grid:hover {
            background-color: #f0f4ff;
        }
        
        /* Responsive */
        @media (max-width: 1200px) {
            .main {
                padding: 1.5rem;
            }
            
            .ai-assistant, .quiz-panel {
                width: 300px;
            }
        }
        
        @media (max-width: 992px) {
            .notes-panel {
                width: 300px;
            }
        }
        
        @media (max-width: 768px) {
            header {
                flex-direction: column;
                gap: 1rem;
                padding: 1rem;
            }
            
            .search-container {
                margin: 0;
                width: 100%;
                order: 3;
            }
            
            .filter-container {
                width: 100%;
                justify-content: space-between;
            }
            
            .video-grid {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            }
            
            .ai-assistant, .quiz-panel {
                width: calc(100% - 2rem);
                left: 1rem;
                right: 1rem;
                bottom: 1rem;
            }
            
            .notes-panel {
                width: 100%;
            }
        }
        
        @media (max-width: 576px) {
            .main {
                padding: 1rem;
            }
            
            .video-grid {
                grid-template-columns: 1fr;
            }
            
            .action-buttons {
                gap: 0.5rem;
            }
            
            .action-btn span {
                display: none;
            }
            
            .description-meta {
                flex-direction: column;
                gap: 0.3rem;
            }
        }
        
        /* Animations */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .pulse {
            animation: pulse 1.5s infinite;
        }
    </style>
</head>
<body>
    <header>
        <div class="logo-container">
            <button class="back-to-grid" id="back-to-grid" style="display: none;">
                <i class="fas fa-arrow-left"></i>
                <span>Back to Videos</span>
            </button>
            <div class="logo">
                <i class="fas fa-graduation-cap"></i>
                <span>LearnHub</span>
            </div>
        </div>
        
        <div class="search-container">
            <i class="fas fa-search search-icon"></i>
            <input type="text" class="search-bar" placeholder="Search videos, topics, or questions...">
        </div>
        
        <div class="header-controls">
            <div class="filter-container">
                <select id="grade-filter">
                    <option value="">All Grades</option>
                    <option value="1">Class 1</option>
                    <option value="2">Class 2</option>
                    <option value="3">Class 3</option>
                    <option value="4">Class 4</option>
                    <option value="5">Class 5</option>
                    <option value="6">Class 6</option>
                    <option value="7">Class 7</option>
                    <option value="8">Class 8</option>
                    <option value="9">Class 9</option>
                    <option value="10">Class 10</option>
                    <option value="11">Class 11</option>
                    <option value="12">Class 12</option>
                </select>
                <select id="subject-filter">
                    <option value="">All Subjects</option>
                    <option value="math">Mathematics</option>
                    <option value="science">Science</option>
                    <option value="history">History</option>
                    <option value="english">English</option>
                    <option value="geography">Geography</option>
                    <option value="computer">Computer Science</option>
                </select>
            </div>
            
            <div class="user-controls">
                <button class="theme-toggle" id="theme-toggle" title="Toggle dark mode">
                    <i class="fas fa-moon"></i>
                </button>
                <button class="ai-assistant-btn" id="ai-assistant-btn" title="AI Assistant">
                    <i class="fas fa-robot"></i>
                </button>
                <div class="user-avatar">JS</div>
            </div>
        </div>
    </header>
    
    <main class="main">
        <!-- Video Grid View -->
        <div class="video-grid" id="video-grid">
            <!-- Videos will be inserted here by JavaScript -->
        </div>
        
        <!-- Video Detail View -->
        <div class="video-detail" id="video-detail">
            <div class="video-player-container">
                <div class="main-video" id="main-video"></div>
            </div>
            
            <div class="video-actions">
                <div class="action-buttons">
                    <button class="action-btn like" id="like-btn">
                        <i class="far fa-thumbs-up"></i>
                        <span>Like</span>
                    </button>
                    <button class="action-btn bookmark" id="bookmark-btn">
                        <i class="far fa-bookmark"></i>
                        <span>Save</span>
                    </button>
                    <button class="action-btn" id="notes-btn">
                        <i class="far fa-edit"></i>
                        <span>Notes</span>
                    </button>
                    <button class="action-btn" id="quiz-btn">
                        <i class="far fa-question-circle"></i>
                        <span>Quiz</span>
                    </button>
                </div>
                <div class="video-progress">
                    <span>25% watched</span>
                </div>
            </div>
            
            <div class="video-description">
                <div class="description-header">
                    <h2 class="description-title" id="detail-title"></h2>
                    <div class="description-meta">
                        <span id="detail-views"></span>
                        <span id="detail-grade"></span>
                        <span id="detail-subject"></span>
                    </div>
                </div>
                <p class="description-text" id="detail-description"></p>
                <div class="tags" id="detail-tags"></div>
            </div>
            
            <!-- Learning Path -->
            <div class="learning-path">
                <div class="section-header">
                    <h3 class="section-title">
                        <i class="fas fa-map-signs"></i>
                        Learning Path
                    </h3>
                    <span class="view-all">View full path <i class="fas fa-chevron-right"></i></span>
                </div>
                
                <div class="path-list" id="learning-path">
                    <!-- Path items will be inserted here -->
                </div>
            </div>
            
            <!-- Related videos -->
            <div class="related-videos">
                <div class="section-header">
                    <h3 class="section-title">
                        <i class="fas fa-users-class"></i>
                        More from this class
                    </h3>
                    <span class="view-all">View all <i class="fas fa-chevron-right"></i></span>
                </div>
                <div class="related-by-class" id="related-by-class">
                    <!-- Class-related videos will be inserted here -->
                </div>
                
                <div class="section-header">
                    <h3 class="section-title">
                        <i class="fas fa-atom"></i>
                        Similar subjects
                    </h3>
                    <span class="view-all">View all <i class="fas fa-chevron-right"></i></span>
                </div>
                <div class="related-by-subject" id="related-by-subject">
                    <!-- Subject-related videos will be inserted here -->
                </div>
            </div>
        </div>
    </main>
    
    <!-- AI Assistant Panel -->
    <div class="ai-assistant" id="ai-assistant">
        <div class="ai-header">
            <div class="ai-title">
                <i class="fas fa-robot pulse"></i>
                <span>LearnHub AI Assistant</span>
            </div>
            <button class="ai-close" id="ai-close">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="ai-messages" id="ai-messages">
            <div class="message ai-message">
                Hi there! I'm your AI learning assistant. How can I help you with this topic?
            </div>
        </div>
        <div class="ai-input-container">
            <input type="text" class="ai-input" id="ai-input" placeholder="Ask me anything about this video...">
            <button class="ai-send" id="ai-send">
                <i class="fas fa-paper-plane"></i>
            </button>
        </div>
    </div>
    
    <!-- Notes Panel -->
    <div class="notes-panel" id="notes-panel">
        <div class="notes-header">
            <h3 class="notes-title">
                <i class="far fa-edit"></i>
                My Notes
            </h3>
            <button class="notes-close" id="notes-close">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="notes-content" id="notes-content">
            <!-- Notes will be inserted here -->
        </div>
        <div class="notes-input-container">
            <textarea class="notes-input" id="notes-input" placeholder="Add a new note..."></textarea>
            <button class="notes-save" id="notes-save">Save Note</button>
        </div>
    </div>
    
    <!-- Quiz Panel -->
    <div class="quiz-panel" id="quiz-panel">
        <div class="quiz-header">
            <div class="quiz-title">
                <i class="fas fa-question-circle"></i>
                <span>Knowledge Check</span>
            </div>
            <button class="quiz-close" id="quiz-close">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="quiz-content" id="quiz-content">
            <!-- Quiz questions will be inserted here -->
        </div>
        <div class="quiz-footer">
            <span class="quiz-progress" id="quiz-progress">Question 1 of 5</span>
            <button class="quiz-next" id="quiz-next" disabled>Next</button>
        </div>
    </div>
    
    <script>
        // Enhanced video data with more properties
        const videos = [
            {
                id: '1',
                title: 'Introduction to Algebra: Variables and Expressions',
                description: 'In this comprehensive lesson, we explore the fundamental concepts of algebraic variables and expressions. You\'ll learn how to represent real-world situations using algebraic notation, simplify expressions, and evaluate them for given values. Perfect for beginners or as a refresher!',
                grade: '8',
                subject: 'math',
                thumbnail: 'https://images.unsplash.com/photo-1635070041078-e363dbe005cb?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=800&q=80',
                videoUrl: 'https://www.youtube.com/embed/VIDEO_ID_1',
                views: '125,000 views',
                duration: '12:45',
                progress: 25,
                tags: ['algebra', 'variables', 'expressions', 'beginner'],
                learningPath: [
                    { id: '1', title: 'Pre-Algebra Basics', completed: true },
                    { id: '2', title: 'Variables and Expressions', completed: false, current: true },
                    { id: '3', title: 'Solving Linear Equations', completed: false },
                    { id: '4', title: 'Graphing Linear Equations', completed: false },
                    { id: '5', title: 'Systems of Equations', completed: false }
                ],
                quiz: [
                    {
                        question: "What is the purpose of variables in algebra?",
                        options: [
                            "To represent unknown quantities",
                            "To make equations look complicated",
                            "To replace numbers entirely",
                            "To confuse students"
                        ],
                        answer: 0,
                        explanation: "Variables are used to represent unknown quantities or quantities that can change in value."
                    },
                    {
                        question: "Which of these is an algebraic expression?",
                        options: [
                            "2x + 5",
                            "7 = 3 + 4",
                            "Hello world",
                            "42"
                        ],
                        answer: 0,
                        explanation: "An algebraic expression contains variables, numbers, and operations but no equality sign."
                    }
                ]
            },
            {
                id: '2',
                title: 'World War II: Causes and Major Events',
                description: 'This detailed overview covers the complex causes of World War II, from the Treaty of Versailles to the rise of fascism. We then examine key events including the invasion of Poland, Battle of Britain, Pearl Harbor, D-Day, and the atomic bombings that shaped the course of history.',
                grade: '10',
                subject: 'history',
                thumbnail: 'https://images.unsplash.com/photo-1574786577759-aebe09a843c6?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=800&q=80',
                videoUrl: 'https://www.youtube.com/embed/VIDEO_ID_2',
                views: '89,500 views',
                duration: '18:30',
                progress: 65,
                tags: ['world war 2', 'history', '20th century', 'military'],
                learningPath: [
                    { id: '1', title: 'Interwar Period', completed: true },
                    { id: '2', title: 'Causes of WWII', completed: false, current: true },
                    { id: '3', title: 'Major Battles', completed: false },
                    { id: '4', title: 'Holocaust', completed: false },
                    { id: '5', title: 'Aftermath and Legacy', completed: false }
                ],
                quiz: [
                    {
                        question: "Which event is considered the immediate cause of WWII?",
                        options: [
                            "German invasion of Poland",
                            "Attack on Pearl Harbor",
                            "Russian Revolution",
                            "Stock Market Crash"
                        ],
                        answer: 0,
                        explanation: "Germany's invasion of Poland on September 1, 1939 prompted Britain and France to declare war."
                    }
                ]
            },
            {
                id: '3',
                title: 'Photosynthesis: The Light-Dependent Reactions',
                description: 'Dive deep into the fascinating light-dependent reactions of photosynthesis. We\'ll break down how plants convert light energy into chemical energy, the role of chlorophyll, the electron transport chain, and how ATP and NADPH are produced. Essential knowledge for any biology student!',
                grade: '7',
                subject: 'science',
                thumbnail: 'https://images.unsplash.com/photo-1518562180175-34a163b1c9c9?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=800&q=80',
                videoUrl: 'https://www.youtube.com/embed/VIDEO_ID_3',
                views: '112,300 views',
                duration: '15:20',
                progress: 90,
                tags: ['photosynthesis', 'biology', 'plants', 'cellular processes'],
                learningPath: [
                    { id: '1', title: 'Plant Cell Structure', completed: true },
                    { id: '2', title: 'Chloroplasts and Pigments', completed: true },
                    { id: '3', title: 'Light-Dependent Reactions', completed: false, current: true },
                    { id: '4', title: 'Calvin Cycle', completed: false },
                    { id: '5', title: 'Factors Affecting Photosynthesis', completed: false }
                ],
                quiz: [
                    {
                        question: "Where do the light-dependent reactions occur?",
                        options: [
                            "Thylakoid membrane",
                            "Stroma",
                            "Mitochondria",
                            "Cell wall"
                        ],
                        answer: 0,
                        explanation: "The light-dependent reactions occur in the thylakoid membranes of chloroplasts."
                    }
                ]
            },
            {
                id: '4',
                title: 'Geometry Basics: Types of Angles and Their Measures',
                description: 'Master the fundamentals of angles in geometry with this beginner-friendly tutorial. Learn to identify and measure acute, right, obtuse, straight, and reflex angles. We\'ll also cover complementary and supplementary angles with plenty of visual examples and practice problems.',
                grade: '6',
                subject: 'math',
                thumbnail: 'https://images.unsplash.com/photo-1639754390580-2e7437267698?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=800&q=80',
                videoUrl: 'https://www.youtube.com/embed/VIDEO_ID_4',
                views: '76,800 views',
                duration: '10:15',
                progress: 10,
                tags: ['geometry', 'angles', 'measurement', 'beginner'],
                learningPath: [
                    { id: '1', title: 'Points, Lines, and Planes', completed: true },
                    { id: '2', title: 'Types of Angles', completed: false, current: true },
                    { id: '3', title: 'Angle Relationships', completed: false },
                    { id: '4', title: 'Polygons', completed: false },
                    { id: '5', title: 'Triangles and Their Properties', completed: false }
                ],
                quiz: [
                    {
                        question: "What is the measure of a right angle?",
                        options: [
                            "90 degrees",
                            "180 degrees",
                            "45 degrees",
                            "360 degrees"
                        ],
                        answer: 0,
                        explanation: "A right angle measures exactly 90 degrees."
                    }
                ]
            },
            {
                id: '5',
                title: 'The Water Cycle: Processes and Importance',
                description: 'Explore the continuous movement of water on Earth through evaporation, condensation, precipitation, and collection. This lesson explains each stage of the water cycle with real-world examples and discusses why this process is crucial for all life on our planet. Includes interactive diagrams!',
                grade: '5',
                subject: 'science',
                thumbnail: 'https://images.unsplash.com/photo-1613535449480-bb56b88d1886?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=800&q=80',
                videoUrl: 'https://www.youtube.com/embed/VIDEO_ID_5',
                views: '94,200 views',
                duration: '8:45',
                progress: 50,
                tags: ['water cycle', 'earth science', 'hydrology', 'environment'],
                learningPath: [
                    { id: '1', title: 'States of Water', completed: true },
                    { id: '2', title: 'The Water Cycle', completed: false, current: true },
                    { id: '3', title: 'Water Distribution on Earth', completed: false },
                    { id: '4', title: 'Human Impact on Water Cycle', completed: false }
                ],
                quiz: [
                    {
                        question: "Which process changes water from liquid to gas?",
                        options: [
                            "Evaporation",
                            "Condensation",
                            "Precipitation",
                            "Collection"
                        ],
                        answer: 0,
                        explanation: "Evaporation is the process where liquid water changes to water vapor (gas)."
                    }
                ]
            },
            {
                id: '6',
                title: 'Shakespeare\'s Romeo and Juliet: Themes and Analysis',
                description: 'Dive into Shakespeare\'s timeless tragedy with this in-depth analysis. We\'ll explore major themes like love, fate, and family conflict, analyze key scenes, and discuss the play\'s historical context. Perfect for students studying this classic work of literature.',
                grade: '9',
                subject: 'english',
                thumbnail: 'https://images.unsplash.com/photo-1544947950-fa07a98d237f?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=800&q=80',
                videoUrl: 'https://www.youtube.com/embed/VIDEO_ID_6',
                views: '68,700 views',
                duration: '22:10',
                progress: 75,
                tags: ['shakespeare', 'literature', 'drama', 'tragedy'],
                learningPath: [
                    { id: '1', title: 'Elizabethan Theater', completed: true },
                    { id: '2', title: 'Shakespeare\'s Life', completed: true },
                    { id: '3', title: 'Romeo and Juliet Analysis', completed: false, current: true },
                    { id: '4', title: 'Literary Devices', completed: false },
                    { id: '5', title: 'Modern Adaptations', completed: false }
                ],
                quiz: [
                    {
                        question: "What is the main conflict between the two families?",
                        options: [
                            "Long-standing feud",
                            "Business competition",
                            "Religious differences",
                            "Land dispute"
                        ],
                        answer: 0,
                        explanation: "The Montagues and Capulets have a long-standing, unexplained feud."
                    }
                ]
            },
            {
                id: '7',
                title: 'Ancient Egyptian Civilization: Pyramids and Pharaohs',
                description: 'Journey back to ancient Egypt and discover one of humanity\'s most fascinating civilizations. This lesson covers the construction of the pyramids, the role of pharaohs, Egyptian gods and religion, and daily life along the Nile. Packed with archaeological insights!',
                grade: '6',
                subject: 'history',
                thumbnail: 'https://images.unsplash.com/photo-1503177119275-0aa32b3a9368?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=800&q=80',
                videoUrl: 'https://www.youtube.com/embed/VIDEO_ID_7',
                views: '103,400 views',
                duration: '14:50',
                progress: 30,
                tags: ['ancient egypt', 'pyramids', 'pharaohs', 'archaeology'],
                learningPath: [
                    { id: '1', title: 'Nile River Civilization', completed: true },
                    { id: '2', title: 'Pyramids and Pharaohs', completed: false, current: true },
                    { id: '3', title: 'Hieroglyphics', completed: false },
                    { id: '4', title: 'Egyptian Religion', completed: false },
                    { id: '5', title: 'Decline of Ancient Egypt', completed: false }
                ],
                quiz: [
                    {
                        question: "Why was the Nile River important to ancient Egypt?",
                        options: [
                            "All of these",
                            "Source of water",
                            "Fertile soil from flooding",
                            "Transportation route"
                        ],
                        answer: 0,
                        explanation: "The Nile provided water, fertile soil through annual floods, and transportation."
                    }
                ]
            },
            {
                id: '8',
                title: 'Fractions: Addition and Subtraction with Unlike Denominators',
                description: 'Struggling with fractions? This step-by-step tutorial makes adding and subtracting fractions with different denominators easy to understand. Learn to find the least common denominator, convert fractions, and simplify your answers. Includes practice problems with solutions.',
                grade: '4',
                subject: 'math',
                thumbnail: 'https://images.unsplash.com/photo-1635070041078-e363dbe005cb?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=800&q=80',
                videoUrl: 'https://www.youtube.com/embed/VIDEO_ID_8',
                views: '145,600 views',
                duration: '9:30',
                progress: 85,
                tags: ['fractions', 'arithmetic', 'denominators', 'elementary math'],
                learningPath: [
                    { id: '1', title: 'Fraction Basics', completed: true },
                    { id: '2', title: 'Like Denominators', completed: true },
                    { id: '3', title: 'Unlike Denominators', completed: false, current: true },
                    { id: '4', title: 'Mixed Numbers', completed: false },
                    { id: '5', title: 'Fraction Word Problems', completed: false }
                ],
                quiz: [
                    {
                        question: "What is the first step when adding fractions with different denominators?",
                        options: [
                            "Find a common denominator",
                            "Add the numerators",
                            "Multiply the denominators",
                            "Convert to decimals"
                        ],
                        answer: 0,
                        explanation: "You must first find a common denominator before adding fractions with different denominators."
                    }
                ]
            }
        ];
        
        // DOM elements
        const videoGrid = document.getElementById('video-grid');
        const videoDetail = document.getElementById('video-detail');
        const mainVideo = document.getElementById('main-video');
        const detailTitle = document.getElementById('detail-title');
        const detailViews = document.getElementById('detail-views');
        const detailGrade = document.getElementById('detail-grade');
        const detailSubject = document.getElementById('detail-subject');
        const detailDescription = document.getElementById('detail-description');
        const detailTags = document.getElementById('detail-tags');
        const relatedByClass = document.getElementById('related-by-class');
        const relatedBySubject = document.getElementById('related-by-subject');
        const learningPath = document.getElementById('learning-path');
        const searchBar = document.querySelector('.search-bar');
        const gradeFilter = document.getElementById('grade-filter');
        const subjectFilter = document.getElementById('subject-filter');
        const backToGridBtn = document.getElementById('back-to-grid');
        const likeBtn = document.getElementById('like-btn');
        const bookmarkBtn = document.getElementById('bookmark-btn');
        const notesBtn = document.getElementById('notes-btn');
        const quizBtn = document.getElementById('quiz-btn');
        const themeToggle = document.getElementById('theme-toggle');
        const aiAssistantBtn = document.getElementById('ai-assistant-btn');
        const aiAssistant = document.getElementById('ai-assistant');
        const aiClose = document.getElementById('ai-close');
        const aiMessages = document.getElementById('ai-messages');
        const aiInput = document.getElementById('ai-input');
        const aiSend = document.getElementById('ai-send');
        const notesPanel = document.getElementById('notes-panel');
        const notesClose = document.getElementById('notes-close');
        const notesContent = document.getElementById('notes-content');
        const notesInput = document.getElementById('notes-input');
        const notesSave = document.getElementById('notes-save');
        const quizPanel = document.getElementById('quiz-panel');
        const quizClose = document.getElementById('quiz-close');
        const quizContent = document.getElementById('quiz-content');
        const quizProgress = document.getElementById('quiz-progress');
        const quizNext = document.getElementById('quiz-next');
        
        // Current video state
        let currentVideo = null;
        let likedVideos = JSON.parse(localStorage.getItem('likedVideos')) || [];
        let bookmarkedVideos = JSON.parse(localStorage.getItem('bookmarkedVideos')) || [];
        let notes = JSON.parse(localStorage.getItem('videoNotes')) || {};
        let darkMode = localStorage.getItem('darkMode') === 'true';
        let currentQuiz = null;
        let currentQuestionIndex = 0;
        let selectedOption = null;
        
        // Initialize the page
        function init() {
            displayVideos(videos);
            setupEventListeners();
            checkDarkMode();
        }
        
        // Display videos in grid view
        function displayVideos(videosToDisplay) {
            videoGrid.innerHTML = '';
            videosToDisplay.forEach(video => {
                const videoCard = document.createElement('div');
                videoCard.className = 'video-card';
                
                const isNew = Math.random() > 0.7; // 30% chance to be "new"
                const isBookmarked = bookmarkedVideos.includes(video.id);
                
                videoCard.innerHTML = `
                    <div class="thumbnail-container">
                        <img src="${video.thumbnail}" alt="${video.title}" class="thumbnail">
                        <span class="duration">${video.duration}</span>
                        ${isNew ? '<span class="video-card-badge">NEW</span>' : ''}
                        ${isBookmarked ? '<span class="video-card-badge" style="background-color: var(--warning-color); top: 2.5rem;"><i class="fas fa-bookmark"></i></span>' : ''}
                        <div class="progress-container">
                            <div class="progress-bar" style="width: ${video.progress}%"></div>
                        </div>
                    </div>
                    <div class="video-info">
                        <h3 class="video-title">${video.title}</h3>
                        <p class="video-meta">
                            <span>Grade ${video.grade}</span>
                            <i class="fas fa-circle" style="font-size: 0.3rem;"></i>
                            <span>${video.subject.charAt(0).toUpperCase() + video.subject.slice(1)}</span>
                            <i class="fas fa-circle" style="font-size: 0.3rem;"></i>
                            <span>${video.views}</span>
                        </p>
                    </div>
                `;
                videoCard.addEventListener('click', () => showVideoDetail(video));
                videoGrid.appendChild(videoCard);
            });
        }
        
        // Show video detail view
        function showVideoDetail(video) {
            currentVideo = video;
            
            // Set main video details
            mainVideo.innerHTML = `
                <iframe width="100%" height="100%" src="${video.videoUrl}?autoplay=1" 
                frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                allowfullscreen></iframe>
            `;
            detailTitle.textContent = video.title;
            detailViews.textContent = video.views;
            detailGrade.textContent = `Grade ${video.grade}`;
            detailSubject.textContent = video.subject.charAt(0).toUpperCase() + video.subject.slice(1);
            detailDescription.textContent = video.description;
            
            // Set tags
            detailTags.innerHTML = '';
            video.tags.forEach(tag => {
                const tagElement = document.createElement('span');
                tagElement.className = 'tag';
                tagElement.textContent = `#${tag}`;
                detailTags.appendChild(tagElement);
            });
            
            // Set learning path
            learningPath.innerHTML = '';
            video.learningPath.forEach(item => {
                const pathItem = document.createElement('div');
                pathItem.className = 'path-item';
                
                const statusClass = item.completed ? 'completed' : item.current ? 'current' : '';
                
                pathItem.innerHTML = `
                    <div class="path-status ${statusClass}">
                        ${item.completed ? '<i class="fas fa-check"></i>' : 
                          item.current ? '<i class="fas fa-play"></i>' : 
                          '<i class="far fa-circle"></i>'}
                    </div>
                    <div class="path-content">
                        <h4 class="path-title">${item.title}</h4>
                        <div class="path-meta">
                            <span>${item.completed ? 'Completed' : item.current ? 'Current' : 'Upcoming'}</span>
                        </div>
                    </div>
                `;
                learningPath.appendChild(pathItem);
            });
            
            // Find related videos by class
            const classRelated = videos.filter(v => 
                v.grade === video.grade && v.id !== video.id
            );
            
            // Find related videos by subject
            const subjectRelated = videos.filter(v => 
                v.subject === video.subject && v.id !== video.id
            );
            
            // Display related by class
            relatedByClass.innerHTML = '';
            classRelated.forEach(video => {
                const videoCard = createRelatedVideoCard(video);
                relatedByClass.appendChild(videoCard);
            });
            
            // Display related by subject
            relatedBySubject.innerHTML = '';
            subjectRelated.forEach(video => {
                const videoCard = createRelatedVideoCard(video, true);
                relatedBySubject.appendChild(videoCard);
            });
            
            // Update like and bookmark buttons
            updateActionButtons();
            
            // Load notes for this video
            loadNotes(video.id);
            
            // Set up quiz
            currentQuiz = video.quiz;
            currentQuestionIndex = 0;
            
            // Switch views
            videoGrid.style.display = 'none';
            videoDetail.style.display = 'block';
            backToGridBtn.style.display = 'flex';
            
            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
        
        // Create a related video card
        function createRelatedVideoCard(video, horizontal = false) {
            const videoCard = document.createElement('div');
            videoCard.className = horizontal ? 'related-video-card' : 'video-card';
            
            videoCard.innerHTML = `
                <div class="thumbnail-container">
                    <img src="${video.thumbnail}" alt="${video.title}" class="thumbnail">
                    <span class="duration">${video.duration}</span>
                </div>
                <div class="video-info">
                    <h3 class="video-title">${video.title}</h3>
                    <p class="video-meta">
                        <span>${video.views}</span>
                        <i class="fas fa-circle" style="font-size: 0.3rem;"></i>
                        <span>${video.duration}</span>
                    </p>
                </div>
            `;
            videoCard.addEventListener('click', () => showVideoDetail(video));
            return videoCard;
        }
        
        // Update like and bookmark buttons
        function updateActionButtons() {
            if (!currentVideo) return;
            
            const isLiked = likedVideos.includes(currentVideo.id);
            const isBookmarked = bookmarkedVideos.includes(currentVideo.id);
            
            likeBtn.classList.toggle('active', isLiked);
            likeBtn.innerHTML = isLiked ? 
                '<i class="fas fa-thumbs-up"></i><span>Liked</span>' : 
                '<i class="far fa-thumbs-up"></i><span>Like</span>';
                
            bookmarkBtn.classList.toggle('active', isBookmarked);
            bookmarkBtn.innerHTML = isBookmarked ? 
                '<i class="fas fa-bookmark"></i><span>Saved</span>' : 
                '<i class="far fa-bookmark"></i><span>Save</span>';
        }
        
        // Load notes for a video
        function loadNotes(videoId) {
            notesContent.innerHTML = '';
            
            if (notes[videoId] && notes[videoId].length > 0) {
                notes[videoId].forEach((note, index) => {
                    const noteElement = document.createElement('div');
                    noteElement.className = 'note';
                    noteElement.innerHTML = `
                        <div class="note-timestamp">${new Date(note.timestamp).toLocaleString()}</div>
                        <p class="note-text">${note.text}</p>
                        <div class="note-actions">
                            <button class="note-action edit-note" data-index="${index}">
                                <i class="fas fa-edit"></i> Edit
                            </button>
                            <button class="note-action delete-note" data-index="${index}">
                                <i class="fas fa-trash"></i> Delete
                            </button>
                        </div>
                    `;
                    notesContent.appendChild(noteElement);
                });
                
                // Add event listeners for note actions
                document.querySelectorAll('.edit-note').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const index = e.target.getAttribute('data-index');
                        editNote(currentVideo.id, index);
                    });
                });
                
                document.querySelectorAll('.delete-note').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const index = e.target.getAttribute('data-index');
                        deleteNote(currentVideo.id, index);
                    });
                });
            } else {
                notesContent.innerHTML = '<p>No notes yet. Add your first note below!</p>';
            }
        }
        
        // Add a new note
        function addNote(videoId, text) {
            if (!text.trim()) return;
            
            const timestamp = new Date();
            const newNote = { text, timestamp };
            
            if (!notes[videoId]) {
                notes[videoId] = [];
            }
            
            notes[videoId].push(newNote);
            localStorage.setItem('videoNotes', JSON.stringify(notes));
            loadNotes(videoId);
            notesInput.value = '';
        }
        
        // Edit a note
        function editNote(videoId, index) {
            const noteText = notes[videoId][index].text;
            notesInput.value = noteText;
            notesInput.focus();
            
            // Change save button to update
            notesSave.textContent = 'Update Note';
            notesSave.onclick = () => {
                if (!notesInput.value.trim()) return;
                
                notes[videoId][index].text = notesInput.value;
                notes[videoId][index].timestamp = new Date();
                localStorage.setItem('videoNotes', JSON.stringify(notes));
                loadNotes(videoId);
                notesInput.value = '';
                notesSave.textContent = 'Save Note';
                notesSave.onclick = () => addNote(currentVideo.id, notesInput.value);
            };
        }
        
        // Delete a note
        function deleteNote(videoId, index) {
            if (confirm('Are you sure you want to delete this note?')) {
                notes[videoId].splice(index, 1);
                localStorage.setItem('videoNotes', JSON.stringify(notes));
                loadNotes(videoId);
            }
        }
        
        // Load quiz questions
        function loadQuizQuestion() {
            if (!currentQuiz || currentQuestionIndex >= currentQuiz.length) {
                quizPanel.classList.remove('active');
                return;
            }
            
            const question = currentQuiz[currentQuestionIndex];
            quizContent.innerHTML = '';
            
            const questionElement = document.createElement('div');
            questionElement.className = 'quiz-question';
            questionElement.innerHTML = `
                <h4 class="quiz-question-text">${question.question}</h4>
                <div class="quiz-options">
                    ${question.options.map((option, i) => `
                        <div class="quiz-option" data-index="${i}">
                            <div class="option-selector"></div>
                            <div class="option-text">${option}</div>
                        </div>
                    `).join('')}
                </div>
                ${question.explanation ? `
                    <div class="quiz-explanation" style="display: none; margin-top: 1rem; padding: 1rem; background-color: #f8f9fa; border-radius: 8px;">
                        <strong>Explanation:</strong> ${question.explanation}
                    </div>
                ` : ''}
            `;
            quizContent.appendChild(questionElement);
            
            // Update progress
            quizProgress.textContent = `Question ${currentQuestionIndex + 1} of ${currentQuiz.length}`;
            quizNext.disabled = true;
            
            // Add event listeners to options
            document.querySelectorAll('.quiz-option').forEach(option => {
                option.addEventListener('click', function() {
                    if (this.classList.contains('selected')) return;
                    
                    // Remove selection from all options
                    document.querySelectorAll('.quiz-option').forEach(opt => {
                        opt.classList.remove('selected');
                    });
                    
                    // Select this option
                    this.classList.add('selected');
                    selectedOption = parseInt(this.getAttribute('data-index'));
                    quizNext.disabled = false;
                });
            });
        }
        
        // Check answer and proceed
        function checkAnswerAndProceed() {
            const question = currentQuiz[currentQuestionIndex];
            const selectedElement = document.querySelector('.quiz-option.selected');
            
            if (selectedElement) {
                const isCorrect = selectedOption === question.answer;
                
                // Show correct/incorrect styling
                document.querySelectorAll('.quiz-option').forEach((option, i) => {
                    if (i === question.answer) {
                        option.classList.add('correct');
                    } else if (i === selectedOption && !isCorrect) {
                        option.classList.add('incorrect');
                    }
                });
                
                // Show explanation if available
                const explanation = document.querySelector('.quiz-explanation');
                if (explanation) {
                    explanation.style.display = 'block';
                }
                
                // Update button text
                quizNext.textContent = currentQuestionIndex < currentQuiz.length - 1 ? 'Next Question' : 'Finish Quiz';
                
                // Disable further selection
                document.querySelectorAll('.quiz-option').forEach(option => {
                    option.style.pointerEvents = 'none';
                });
                
                // Prepare for next question
                quizNext.onclick = proceedToNextQuestion;
            }
        }
        
        // Proceed to next question
        function proceedToNextQuestion() {
            currentQuestionIndex++;
            
            if (currentQuestionIndex < currentQuiz.length) {
                loadQuizQuestion();
            } else {
                // Quiz completed
                quizPanel.classList.remove('active');
                currentQuestionIndex = 0;
                quizNext.textContent = 'Next';
                quizNext.onclick = checkAnswerAndProceed;
                
                // Show completion message
                alert('Quiz completed! Great job!');
            }
        }
        
        // Toggle dark mode
        function toggleDarkMode() {
            darkMode = !darkMode;
            document.body.classList.toggle('dark-mode', darkMode);
            localStorage.setItem('darkMode', darkMode);
            
            themeToggle.innerHTML = darkMode ? 
                '<i class="fas fa-sun"></i>' : 
                '<i class="fas fa-moon"></i>';
        }
        
        // Check and apply dark mode preference
        function checkDarkMode() {
            if (darkMode) {
                document.body.classList.add('dark-mode');
                themeToggle.innerHTML = '<i class="fas fa-sun"></i>';
            }
        }
        
        // Back to grid view
        function backToGrid() {
            videoDetail.style.display = 'none';
            videoGrid.style.display = 'grid';
            backToGridBtn.style.display = 'none';
            mainVideo.innerHTML = ''; // Stop video playback
            
            // Close all panels
            aiAssistant.classList.remove('active');
            notesPanel.classList.remove('active');
            quizPanel.classList.remove('active');
        }
        
        // Filter videos based on search and filters
        function filterVideos() {
            const searchTerm = searchBar.value.toLowerCase();
            const selectedGrade = gradeFilter.value;
            const selectedSubject = subjectFilter.value;
            
            const filteredVideos = videos.filter(video => {
                const matchesSearch = video.title.toLowerCase().includes(searchTerm) || 
                                    video.description.toLowerCase().includes(searchTerm) ||
                                    video.tags.some(tag => tag.includes(searchTerm));
                const matchesGrade = !selectedGrade || video.grade === selectedGrade;
                const matchesSubject = !selectedSubject || video.subject === selectedSubject;
                
                return matchesSearch && matchesGrade && matchesSubject;
            });
            
            displayVideos(filteredVideos);
        }
        
        // Set up event listeners
        function setupEventListeners() {
            // Search and filter
            searchBar.addEventListener('keyup', (e) => {
                if (e.key === 'Enter') filterVideos();
            });
            
            gradeFilter.addEventListener('change', filterVideos);
            subjectFilter.addEventListener('change', filterVideos);
            
            // Back to grid
            backToGridBtn.addEventListener('click', backToGrid);
            
            // Like button
            likeBtn.addEventListener('click', () => {
                if (!currentVideo) return;
                
                const index = likedVideos.indexOf(currentVideo.id);
                if (index === -1) {
                    likedVideos.push(currentVideo.id);
                } else {
                    likedVideos.splice(index, 1);
                }
                
                localStorage.setItem('likedVideos', JSON.stringify(likedVideos));
                updateActionButtons();
            });
            
            // Bookmark button
            bookmarkBtn.addEventListener('click', () => {
                if (!currentVideo) return;
                
                const index = bookmarkedVideos.indexOf(currentVideo.id);
                if (index === -1) {
                    bookmarkedVideos.push(currentVideo.id);
                } else {
                    bookmarkedVideos.splice(index, 1);
                }
                
                localStorage.setItem('bookmarkedVideos', JSON.stringify(bookmarkedVideos));
                updateActionButtons();
                
                // Refresh grid view to update bookmark indicators
                if (videoGrid.style.display === 'grid') {
                    filterVideos();
                }
            });
            
            // Notes button
            notesBtn.addEventListener('click', () => {
                notesPanel.classList.toggle('active');
            });
            
            notesClose.addEventListener('click', () => {
                notesPanel.classList.remove('active');
            });
            
            notesSave.addEventListener('click', () => {
                addNote(currentVideo.id, notesInput.value);
            });
            
            // Quiz button
            quizBtn.addEventListener('click', () => {
                if (currentQuiz && currentQuiz.length > 0) {
                    quizPanel.classList.add('active');
                    loadQuizQuestion();
                } else {
                    alert('No quiz available for this video.');
                }
            });
            
            quizClose.addEventListener('click', () => {
                quizPanel.classList.remove('active');
            });
            
            quizNext.addEventListener('click', checkAnswerAndProceed);
            
            // AI Assistant
            aiAssistantBtn.addEventListener('click', () => {
                aiAssistant.classList.toggle('active');
                
                if (aiAssistant.classList.contains('active')) {
                    // Add welcome message if empty
                    if (aiMessages.children.length === 1) {
                        const welcomeMsg = document.createElement('div');
                        welcomeMsg.className = 'message ai-message';
                        welcomeMsg.innerHTML = `
                            I can help you understand <strong>${currentVideo.title}</strong>. 
                            Ask me anything about:
                            <ul style="margin-top: 0.5rem; padding-left: 1.5rem;">
                                ${currentVideo.tags.map(tag => `<li>${tag}</li>`).join('')}
                            </ul>
                        `;
                        aiMessages.appendChild(welcomeMsg);
                    }
                }
            });
            
            aiClose.addEventListener('click', () => {
                aiAssistant.classList.remove('active');
            });
            
            aiSend.addEventListener('click', sendAIMessage);
            aiInput.addEventListener('keyup', (e) => {
                if (e.key === 'Enter') sendAIMessage();
            });
            
            // Theme toggle
            themeToggle.addEventListener('click', toggleDarkMode);
        }
        
        // Send message to AI assistant
        function sendAIMessage() {
            const message = aiInput.value.trim();
            if (!message) return;
            
            // Add user message
            const userMsg = document.createElement('div');
            userMsg.className = 'message user-message';
            userMsg.textContent = message;
            aiMessages.appendChild(userMsg);
            
            // Clear input
            aiInput.value = '';
            
            // Scroll to bottom
            aiMessages.scrollTop = aiMessages.scrollHeight;
            
            // Simulate AI response (in a real app, this would call an API)
            setTimeout(() => {
                const aiMsg = document.createElement('div');
                aiMsg.className = 'message ai-message';
                
                // Simple response logic based on keywords
                if (message.toLowerCase().includes('summary')) {
                    aiMsg.innerHTML = `Here's a summary of <strong>${currentVideo.title}</strong>:<br><br>
                    ${currentVideo.description.substring(0, 200)}...`;
                } 
                else if (message.toLowerCase().includes('grade') || message.toLowerCase().includes('level')) {
                    aiMsg.textContent = `This video is appropriate for Grade ${currentVideo.grade} students.`;
                }
                else if (message.toLowerCase().includes('tag') || message.toLowerCase().includes('topic')) {
                    aiMsg.innerHTML = `The main topics covered are:<br><br>
                    ${currentVideo.tags.map(tag => `• ${tag.charAt(0).toUpperCase() + tag.slice(1)}`).join('<br>')}`;
                }
                else if (message.toLowerCase().includes('quiz') || message.toLowerCase().includes('test')) {
                    if (currentQuiz && currentQuiz.length > 0) {
                        aiMsg.innerHTML = `There are ${currentQuiz.length} quiz questions available for this video. 
                        <br><br>Click the <i class="far fa-question-circle"></i> button to start the quiz.`;
                    } else {
                        aiMsg.textContent = "There's no quiz available for this video.";
                    }
                }
                else {
                    aiMsg.innerHTML = `I understand you're asking about <strong>"${message}"</strong> in relation to ${currentVideo.title}.<br><br>
                    While I can't provide specific answers in this demo, a real implementation would use AI to analyze the video content 
                    and provide detailed explanations, clarifications, and additional resources.`;
                }
                
                aiMessages.appendChild(aiMsg);
                aiMessages.scrollTop = aiMessages.scrollHeight;
            }, 1000);
        }
        
        // Initialize the app
        init();
    </script>
</body>
</html>
